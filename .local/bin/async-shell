#!/bin/bash

# Prompt for a shell command using Emacs minibuffer (with completion & history)
# The output appears in a floating Emacs frame

emacsclient -c -a emacs \
    -F '((name . "async-shell-popup"))' \
    --eval "(progn
              (switch-to-buffer (get-buffer-create \" *async-prompt*\"))
              (setq mode-line-format nil)
              (let ((cmd (read-shell-command \"Shell command: \")))
                (if (string-empty-p cmd)
                    (delete-frame)
                  (async-shell-command cmd)
                  (delete-window))))"

#!/data/data/com.termux/files/usr/bin/bash
# Bidirectional Dropbox sync for all denote files

DENOTE_DIR="$HOME/storage/shared/Dropbox/org/denote"
REMOTE="Dropbox:org/denote"

mkdir -p "$DENOTE_DIR"

# bisync tracks state and propagates changes (including deletions) both directions
# Falls back to --resync on first run to establish baseline
rclone bisync "$DENOTE_DIR" "$REMOTE" 2>/dev/null || \
  rclone bisync "$DENOTE_DIR" "$REMOTE" --resync 2>/dev/null
termux-notification -t "Denote synced" -c "$(date +%H:%M)"
